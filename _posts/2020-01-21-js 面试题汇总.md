---
layout: post
title: "js é¢è¯•é¢˜æ±‡æ€»"
date: 2020-01-21
sitemap: false
keywords: "blog"
description: "ğŸš€"
---

jså¸¸è§è€ƒç‚¹

## jsé¢è¯•é¢˜æ±‡æ€»
1.è·¨åŸŸè§£å†³æ–¹æ¡ˆ
* jsonp ä¸»è¦åˆ©ç”¨äº†scriptæ ‡ç­¾è¯·æ±‚èµ„æºä¸å—åŒæºç­–ç•¥é™åˆ¶ã€‚ç¼ºç‚¹æ˜¯åªèƒ½å‘èµ·getè¯·æ±‚
* cors è·¨åŸŸèµ„æºå…±äº«
> corsåˆ†ä¸ºç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚  
> ç®€å•è¯·æ±‚getï¼Œpostï¼Œheadä»¥åŠæœ‰é™çš„å¤´ä¿¡æ¯  
> ç®€å•è¯·æ±‚çš„æ­¥éª¤ï¼Œæµè§ˆå™¨å‘ç°æ˜¯è·¨åŸŸè¯·æ±‚ï¼Œè‡ªåŠ¨åŠ ä¸Šå¤´ä¿¡æ¯originï¼ŒæœåŠ¡å™¨è®¾ç½®é€šè¿‡Access-control-allow-originè®¾ç½®å“ªäº›åŸŸåå¯ä»¥è·¨åŸŸè®¿é—®  
> éç®€å•è¯·æ±‚çš„æ­¥éª¤ï¼Œæµè§ˆå™¨å…ˆå‘å‡ºé¢„æ£€è¯·æ±‚ï¼Œå¤´ä¿¡æ¯è¯·æ±‚æ–¹æ³•æ˜¯OPTIONSï¼Œè¯·æ±‚å¤´ä¿¡æ¯è¿˜åŒ…æ‹¬ä¸¤ä¸ªAccess-Control-Requestâ€”Method, Access-Control-Requestâ€”Headersç”¨æ¥åˆ—å‡ºæµè§ˆå™¨çš„corsè¯·æ±‚ä¼šä½¿ç”¨å“ªäº›æ–¹æ³•ä»¥åŠå“ªäº›é¢å¤–çš„å¤´ä¿¡æ¯ï¼Œä¾›æœåŠ¡å™¨æ£€æŸ¥ã€‚ä¹‹åè·Ÿç®€å•è¯·æ±‚ä¸€æ ·
* nginxåå‘ä»£ç†
* postMessage

2.å¸¸è§æ”»å‡»
* csrf ï¼ˆcross-site-request-forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚æ”»å‡»è€…ç›—ç”¨èº«ä»½å‘é€æ¶æ„è¯·æ±‚ã€‚ç”¨æˆ·ä¸¤ä¸ªæ­¥éª¤åˆ†åˆ«æ˜¯ç™»å½•å—ä¿¡ä»»ç½‘ç«™Aï¼Œå¹¶åœ¨æœ¬åœ°ç”Ÿæˆcookieï¼›åœ¨ä¸ç™»å‡ºAçš„æƒ…å†µä¸‹è®¿é—®æ¶æ„ç½‘ç«™Bã€‚
> è§£å†³åŠæ³•  
> * è¡¨å•åŠ å…¥ä¸€ä¸ªhashå­—æ®µï¼Œç„¶ååœ¨æœåŠ¡ç«¯éªŒè¯  
> * éªŒè¯ç ï¼Œæ¯æ¬¡æäº¤è¡¨å•éœ€è¦æºå¸¦éªŒè¯ç ä¸Šçš„éšæœºå­—ç¬¦ä¸²ã€‚å¯¹ç”¨æˆ·ä¸å‹å¥½  
> * cookieçš„Httponlyå±æ€§ï¼Œæ”¾ç½®cookieè¢«è„šæœ¬è¯»å–ã€‚  

* xssæ”»å‡» Cross-site scripting  è·¨ç«™è„šæœ¬æ³¨å…¥

3.cookieå’Œsession
* cookieæ˜¯å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œsessionå­˜å‚¨åœ¨æœåŠ¡ç«¯
* cookieä¸€èˆ¬æœ‰å¤§å°é™åˆ¶ï¼Œsessionçš„å¤§å°å–å†³äºç¡¬ä»¶
* cookieçš„æ—¶æ•ˆæ€§ä¸€èˆ¬è¾ƒé•¿ï¼Œè€Œsessioné€šå¸¸åªå­˜åœ¨äºä¸€æ¬¡ä¼šè¯ä¸­  

4.http1.1ä¸http1.0
* ç¼“å­˜å¤„ç†
* å¸¦å®½ä¼˜åŒ–å’Œç½‘ç»œè¿æ¥çš„ä½¿ç”¨
* é”™è¯¯é€šçŸ¥çš„ç®¡ç†
* é•¿è¿æ¥ï¼Œé»˜è®¤å¼€å¯äº†Connectionï¼škeep-alive

5.http2.0ä¸http1.1
* æ”¯æŒäºŒè¿›åˆ¶ä¼ é€ï¼Œhttp1.xæ˜¯å­—ç¬¦ä¸²ä¼ é€
* å¤šè·¯å¤ç”¨
* å‹ç¼©ç®—æ³•å‹ç¼©å¤´éƒ¨ï¼Œå‡å°ä¼ è¾“ä½“ç§¯
* æ”¯æŒæœåŠ¡ç«¯æ¨é€  

6.ç¼“å­˜
* ç¼“å­˜åˆ†ä¸ºå¼ºç¼“å­˜å’Œåå•†ç¼“å­˜ï¼Œå¼ºç¼“å­˜ä¸è¿‡æœåŠ¡å™¨ï¼Œåå•†ç¼“å­˜éœ€è¦è¿‡æœåŠ¡å™¨ï¼Œåå•†ç¼“å­˜è¿”å›çš„çŠ¶æ€ç æ˜¯304é‡å®šå‘ã€‚
* å¼ºç¼“å­˜Expiresï¼Œä½¿ç”¨ç»å¯¹æ—¶é—´ï¼Œå¯èƒ½ä¼šæœ‰è¯¯å·®
* å¼ºç¼“å­˜Cach-Control 
* å‘½ä¸­å¼ºç¼“å­˜çš„è¡¨ç°å½¢å¼ï¼ŒFirefoxä¸ºä¸€ä¸ªç°è‰²çš„200çŠ¶æ€ç ï¼ŒChromeè¡¨ç°ä¸º200(from disk cashe)
* åå•†ç¼“å­˜Last-Modifiedï¼ŒEtagï¼ŒIf-Modified-Sinceï¼ŒIf-Matchç­‰å­—æ®µ

7.é¦–å±åŠ è½½ä¼˜åŒ–æ–¹æ¡ˆ
* è·¯ç”±æ‡’åŠ è½½
* gzipå‹ç¼©
* æœåŠ¡ç«¯æ¸²æŸ“SSR
* UIåº“æŒ‰éœ€åŠ è½½

8.æ•°æ®åŠ«æŒï¼ˆæ•°æ®ä»£ç†ï¼‰
* defineProperty,vueçš„å“åº”å¼åŸç†  

9.Event loop äº‹ä»¶å¾ªç¯æœºåˆ¶
* jsæ˜¯å•çº¿ç¨‹ï¼ˆåªæœ‰ä¸€ä¸ªä¸»çº¿ç¨‹ï¼‰ï¼Œéé˜»å¡ï¼ˆäº‹ä»¶å¾ªç¯ï¼‰çš„è„šæœ¬è¯­è¨€
* Event loopä¸»è¦åˆ†ä¸ºä¸»çº¿ç¨‹ï¼Œå®ä»»åŠ¡ï¼ˆmacrotaskï¼‰ï¼Œå¾®ä»»åŠ¡ï¼ˆmicrotaskï¼‰
* ä¸»çº¿ç¨‹åŒ…æ‹¬jsæ–‡ä»¶é‡Œå¯ä»¥ç›´æ¥åœ¨å½“å‰ä½œç”¨åŸŸæ‰§è¡Œçš„æ‰€æœ‰å†…å®¹
* å®ä»»åŠ¡åŒ…æ‹¬setTimeout, setInterval, setImmediateï¼ˆnodeç‹¬æœ‰ï¼‰, I/O, UI renderï¼ˆæµè§ˆå™¨ç‹¬æœ‰ï¼‰ï¼ŒrequestAnimationFrameï¼ˆæµè§ˆå™¨ç‹¬æœ‰ï¼‰
* å¾®ä»»åŠ¡åŒ…æ‹¬ï¼Œ promise.then ,process.nextTickï¼ˆnodeç‹¬æœ‰ï¼‰
* æ‰§è¡Œé¡ºåºä¸ºï¼Œä¸»çº¿ç¨‹--->å¾®ä»»åŠ¡--->å®é˜Ÿåˆ—ä¸­çš„ä¸€ä¸ªä»»åŠ¡--->å¾®ä»»åŠ¡....ä¾æ¬¡å¾ªç¯ï¼Œ åœ¨æ‰§è¡Œå¾®ä»»åŠ¡çš„è¿‡ç¨‹ä¸­å¦‚æœåˆäº§ç”Ÿäº†å¾®ä»»åŠ¡ï¼Œé‚£ä¹ˆä¼šåŠ å…¥åˆ°é˜Ÿåˆ—çš„æœ«å°¾ï¼Œä¹Ÿä¼šåœ¨è¿™ä¸ªå‘¨æœŸè¢«è°ƒç”¨æ‰§è¡Œ
* nodejsä¸­çš„å®ä»»åŠ¡åˆ†æˆäº†å…­ç§é˜Ÿåˆ—ï¼Œä¾æ¬¡æ‰§è¡Œ
* nodejsä¸­çš„æ‰§è¡Œé¡ºåºä¸ºï¼Œä¸»çº¿ç¨‹--->å¾®ä»»åŠ¡--->ç¬¬ä¸€ä¸ªå®é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰ä»»åŠ¡--->å¾®ä»»åŠ¡....ä¾æ¬¡å¾ªç¯

10.jså®ç°bind
```javascript
Function.prototype.bind = function (oThis) { if (typeof this !== "function") { 
      throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
    } var aArgs = Array.prototype.slice.call(arguments, 1), 
        fToBind = this, 
        fNOP = function () {},
        fBound = function () { return fToBind.apply(this instanceof fNOP && oThis ? this : oThis || window,
                               aArgs.concat(Array.prototype.slice.call(arguments)));
        };

    fNOP.prototype = this.prototype;
    fBound.prototype = new fNOP(); return fBound;
  };
  ```
 11.é˜²æŠ–ä¸èŠ‚æµ
 > *  åœ¨è¿›è¡Œçª—å£çš„resizeï¼Œscrollç­‰æ“ä½œæ—¶ï¼Œå¦‚æœäº‹ä»¶å¤„ç†å‡½æ•°è°ƒç”¨é¢‘ç‡æ— é™åˆ¶ï¼Œä¼šå¢åŠ æµè§ˆå™¨çš„è´Ÿæ‹…ï¼Œå¯¼è‡´ç”¨æˆ·ä½“éªŒç³Ÿç³•ã€‚æ‰€ä»¥éœ€è¦é˜²æŠ–ï¼ˆdebounceï¼‰å’ŒèŠ‚æµï¼ˆthrottleï¼‰çš„æ–¹å¼æ¥å‡å°‘è°ƒç”¨é¢‘ç‡ã€‚  
 > * é˜²æŠ–ï¼š å°†å‡ æ¬¡æ“ä½œåˆå¹¶ä¸ºä¸€æ¬¡æ“ä½œè¿›è¡Œï¼ŒåŸç†æ˜¯ç»´æŠ¤ä¸€ä¸ªå®šæ—¶å™¨ï¼Œè§„å®šåœ¨delayæ—¶é—´åè§¦å‘å‡½æ•°ï¼Œå¦‚æœåœ¨delayæ—¶é—´å†…è§¦å‘çš„è¯ï¼Œå°±ä¼šå–æ¶ˆä¹‹å‰çš„å®šæ—¶å™¨é‡æ–°è®¾ç½®ã€‚æ‰€ä»¥åªæœ‰æœ€åä¸€æ¬¡æ“ä½œèƒ½è¢«è§¦å‘  
 > * èŠ‚æµï¼š ä½¿å¾—ä¸€å®šæ—¶é—´å†…åªè§¦å‘ä¸€æ¬¡å‡½æ•°ã€‚  
 
  ç®€å•é˜²æŠ–å®ç°
   ```javascript
   function debounce(fn, wait) {
    var timeout = null;
    return function() { 
	    if(timeout !== null) 
		      clearTimeout(timeout);        
        timeout = setTimeout(fn, wait);    
    }
}
function handle() {    
    console.log(Math.random()); 
}
window.addEventListener('scroll', debounce(handle, 1000));
```   
ç®€å•èŠ‚æµå®ç°
```javascript
var throttle = function(func, delay) {            
    var timer = null;            
    return function() {                
        var context = this;               
        var args = arguments;                
        if (!timer) {                    
            timer = setTimeout(function() {                        
                func.apply(context, args);                        
                timer = null;                    
            }, delay);                
        }            
    }        
}        
function handle() {            
    console.log(Math.random());        
}        
window.addEventListener('scroll', throttle(handle, 1000));
```    

12.commonjsä¸­module.exportså’Œexportsçš„åŒºåˆ«
æ¨¡å—æœ€ç»ˆè¿”å›çš„æ˜¯module.exports,exportsä¸ºæŒ‡å‘module.exportsçš„å¼•ç”¨ã€‚

13.jså®ç°newæ“ä½œç¬¦
* åˆ›å»ºæ–°çš„å¯¹è±¡
* å°†æ–°å¯¹è±¡çš„__proto__å±æ€§æŒ‡å‘æ„é€ å‡½æ•°çš„prototypeå¯¹è±¡
* ä½¿æ„é€ å‡½æ•°çš„thisæŒ‡å‘è¯¥å¯¹è±¡
* å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ç±»å‹ï¼Œnewè¡¨è¾¾å¼çš„å‡½æ•°è°ƒç”¨å°†ä¼šè¿”å›è¯¥å¯¹è±¡çš„å¼•ç”¨
```javascript
function New(func){
	let res={}
	if(func.prototype!==null){
		res.__proto__=func.prototype}
	let ret=func.apply(res,Array.prototype.slice.call(arguments,1))
	if((typeof ret==="object"||typeof ret==="function")&&ret !==null{
		return ret}
	return res
	}
```
14.jså®ç°call,applyç±»ä¼¼
```javascript
Function.prototype.mycall=function(content=window){
	content.fn=this
	let args=[...arguments].slice(1)
	let result=content.fn(...args)
	delete content.fn
	return result
	}
```
15.jså®ç°ç»§æ‰¿
```javascript
function inherit(child,parent){
	function F(){}
	F.prototype=parent.prototype
	child.prototype=new F()
	child.protype.constructor=child}
```
16.å‡½æ•°æŸ¯é‡ŒåŒ–
```javascript
function  curry(fn,args){
	let  length=fn.length
	var  args=args||[]
	return  function(){
		let  newargs=args.concat(Array.prototype.slice.call(arguments))
		if(newargs.length<length){
			return  curry.call(this,fn,newargs)
		}else{
			return  fn.apply(this,newargs)
			}
	}
}
function  multiFn(a,b,c){
console.log(a*b*c)
}
var  multi=curry(multiFn)
multi(2)(3)(4);
multi(2,3,4);
multi(2)(3,4);
multi(2,3)(4);
```
17.jså®ç°promise
> promise A+è§„èŒƒ
> * ä¸‰ç§çŠ¶æ€ pending | fulfilled | rejected
> * å½“å¤„äºpendingçŠ¶æ€æ—¶ï¼Œå¯ä»¥è½¬ç§»åˆ°fulfilledæˆ–è€…rejected
> * å½“å¤„äºfulfilledæˆ–è€…rejectedçŠ¶æ€æ—¶ï¼Œå°±ä¸å¯å˜

```javascript
function  myPromise(constructor){
	let  self=this
	self.status="pending"
	self.value=undefined
	self.reason=undefined
	function  resolve(value){
		if(self.status==="pending"){
			self.value=value
			self.status="resolved"
		}}
	function  reject(reason){
		if(self.status==="pending"){
			self.reason=reason	
			self.status="rejected"
		}}
	try{
		constructor(resolve,reject)
		}catch(e){
		reject(e)}
}
myPromise.prototype.then=function(onfulfilled,onrejected){
	let  self=this
	switch(self.status){
		case  "resolved":
			onfulfilled(self.value)
			break
		case  "rejected":
			onrejected(self.reason)
			break
		default:
}
}
```
18.jså®ç°ä¸€ä¸ªinstanceof
```javascript
function instanceof(left,right){
	let proto=left.__proto__
	let prototype=right.prototype
	while(true){
		if(proto===null){
			return false}
		if(proto===prototype){
			return true}
		proto=proto.__proto__;
		}
	}
```
19.jså®ç°æ·±æ‹·è´
```javascript
function deepcopy(obj){
	if(typeof obj==="object"){
		var result=obj.constructor===Array?[]:{}
		for(let i in obj){
			result=typeof obj[i]==="object"?deepcopy(obj[i]):obj[i]
			}
	}
	else{
		return obj
	}
	return result}			
```
20.æ„é€ å‡½æ•°çš„return
> æ„é€ å‡½æ•°ä¸éœ€è¦æ˜¾å¼åœ°è¿”å›å€¼ã€‚ä½¿ç”¨newæ¥åˆ›å»ºå¯¹è±¡ï¼ˆè°ƒç”¨æ„é€ å‡½æ•°ï¼‰æ—¶ï¼Œå¦‚æœreturnçš„æ˜¯éå¯¹è±¡ï¼ˆåŒ…æ‹¬nullï¼‰ï¼Œä¼šå¿½ç•¥è¿”å›å€¼ï¼Œå¦‚æœreturnçš„æ˜¯å¯¹è±¡ï¼Œåˆ™è¿”å›è¯¥å¯¹è±¡ã€‚

21.æ•°ç»„çš„æ‰å¹³åŒ–å®ç°
es6å®ç°
```javascript
function flatten(arr){
	while(arr.some(item=>Array.isArray(item)){
		arr=[].concat(...arr);}
	return arr;
	} 
```
é€’å½’å®ç°
```javascript
function flatten(arr){
	let res=[]
	for(let i of arr){
		if(Array.isArray(i)){
			res=res.concat(flatten(i))}
		res.push(i)}
	return res}
```
22.æ•°ç»„å»é‡
ç®€å•æ–¹æ³•
```javascript
function unique(arr){
	let res=[]
	for(let i of arr){
		if(res.indexOf(i)==-1){
			res.push(i)}
		}
	return res
}
```
23.tcpå‘èµ·è¿æ¥å’Œå…³é—­è¿æ¥ï¼ˆä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹ï¼‰  
ä¸‰æ¬¡æ¡æ‰‹
* å‘é€ç«¯å‘é€ä¸€ä¸ªå¸¦æœ‰SYNï¼ˆsynchronizeï¼‰æ ‡å¿—çš„æ•°æ®åŒ…ç»™æ¥æ”¶æ–¹
* æ¥æ”¶æ–¹æ¥æ”¶åï¼Œå›ä¼ ä¸€ä¸ªå¸¦æœ‰SYN/ACKæ ‡å¿—çš„æ•°æ®åŒ…ä¼ é€’ç¡®è®¤ä¿¡æ¯
* æœ€åï¼Œå‘é€æ–¹å†å›ä¼ ä¸€ä¸ªå¸¦æœ‰ACKæ ‡å¿—çš„æ•°æ®åŒ…ï¼Œä»£è¡¨â€˜æˆ‘çŸ¥é“ä½ æ”¶åˆ°æ¶ˆæ¯äº†â€™ï¼Œæ¡æ‰‹ç»“æŸ  

å››æ¬¡æŒ¥æ‰‹
* Clientå‘é€ä¸€ä¸ªFIN,ç”¨æ¥å…³é—­Clientåˆ°Serverçš„æ•°æ®ä¼ é€ï¼ŒClientè¿›å…¥FIN_WAIT_1çŠ¶æ€
* Serveræ”¶åˆ°FINåï¼Œå‘é€ä¸€ä¸ªACKç»™clientï¼ŒServerè¿›å…¥CLOSE_WAITçŠ¶æ€
* Serverå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­Serveråˆ°Clientçš„æ•°æ®ä¼ é€ï¼ŒServerè¿›å…¥LAST_ACKçŠ¶æ€
* Clientæ”¶åˆ°Finåï¼Œè¿›å…¥TIME_WAITçŠ¶æ€ï¼Œæ¥ç€å‘é€ä¸€ä¸ªACKç»™serverï¼ŒServerè¿›å…¥CLOSEDçŠ¶æ€

24.jsåƒåœ¾å›æ”¶æœºåˆ¶
>ä¸€èˆ¬æ¥è¯´æ²¡æœ‰è¢«å¼•ç”¨çš„å¯¹è±¡å°±æ˜¯åƒåœ¾ï¼Œå¦‚æœæ ¹å¯¹è±¡è®¿é—®ä¸åˆ°ï¼Œé‚£ä¹ˆå°±ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶æ¸…é™¤  
>åƒåœ¾å›æ”¶çš„å†…éƒ¨ç®—æ³•æ˜¯â€œæ ‡è®°-æ¸…é™¤â€ï¼Œé¦–å…ˆè·å–æ ¹å…ƒç´ ç„¶åæ ‡è®°æ‰€æœ‰æ¥è‡ªä»–ä»¬çš„å¼•ç”¨ï¼Œä»¥åŠå„¿å­çš„å¼•ç”¨ï¼ŒçŸ¥é“æ‰€æœ‰å¼•ç”¨éƒ½å¯ä»¥ä»æ ¹å…ƒç´ è®¿é—®ã€‚é™¤äº†è¢«æ ‡è®°çš„å¯¹è±¡å¤–ï¼Œæ‰€æœ‰å¯¹è±¡éƒ½è¢«åˆ é™¤ã€‚  

25.jså®ç°åŠ¨ç”»
> å°†divå¹³æ»‘æ»‘åŠ¨ï¼Œç”±å¿«åˆ°æ…¢ã€‚åˆ©ç”¨äº†æµè§ˆå™¨requestAnimationFrame()å‡½æ•°ï¼Œè¯¥å‡½æ•°æ¥å—ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå¹¶ä¼ å…¥æ—¶é—´æˆ³ç»™åˆ°è¿™ä¸ªå›è°ƒï¼Œåœ¨ä¸‹æ¬¡é‡ç»˜ä¹‹å‰è°ƒç”¨è¯¥å‡½æ•°ã€‚é€šå¸¸æµè§ˆå™¨ä¼šåœ¨16msé‡ç»˜ä¸€æ¬¡ï¼Œåˆ·æ–°é¢‘ç‡ä¸º60hzã€‚  
```javascript
<!DOCTYPE html>
<html>
<head>
  <script>
    window.onload = () => {
      var element = document.getElementById('t');

      function step(timestamp) {
        console.log(timestamp)
        var progress = timestamp;
        element.style.left = Math.pow(progress / 5, .5) * 40 + 'px';
        if (progress < 5000) {
          window.requestAnimationFrame(step);
        } else {
          window.cancelAnimationFrame(step)
        }
      }

      window.requestAnimationFrame(step);
    }
  </script>
  <style>
    .container {
      position: relative;
      width: 1000px;
    }
    #t {
      position: absolute;
      width: 50px;
      height: 50px;
      background: red;
    }
  </style>
</head>

<body>
  <div class="container">
    <div id="t"></div>
  </div>
</body>
</html>
```
