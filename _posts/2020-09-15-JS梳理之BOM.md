---
layout: post
title: "JSæ¢³ç†ä¹‹BOM"
date: 2020-09-15
sitemap: false
keywords: "blog"
description: "ğŸš€"
---

BOMæ¢³ç†

## æ¦‚è¿°
ä»£ç åµŒå…¥ç½‘é¡µçš„æ–¹æ³•
* scriptç›´æ¥å†™å…¥, è¿™ä¸ªæ ‡ç­¾æœ‰ä¸€ä¸ªtypeå±æ€§ä¸€èˆ¬ä¸º`application/javascript`,å¦‚æœtypeæ”¹æˆäº†æµè§ˆå™¨ä¸è®¤è¯†çš„å­—æ®µï¼Œé‚£ä¹ˆè¿™è¡Œä»£ç ä¸ä¼šæ‰§è¡Œã€‚ä½†æ˜¯æ ‡ç­¾ä»ç„¶å­˜åœ¨äºdomä¸­
* scriptå¤–éƒ¨å¼•å…¥,å¦‚æœå¼•å…¥çš„è„šæœ¬æœ‰éè‹±è¯­å­—ç¬¦åº”è¯¥ç”¨`charset`æ³¨æ˜ç¼–ç ,è¿˜å…è®¸è®¾ç½®ä¸€ä¸ª`integrity`å±æ€§å†™å…¥å¤–éƒ¨è„šæœ¬çš„hashç­¾å(srcå±æ€§çš„hashå€¼),å¦‚æœsrcå±æ€§è¢«ç¯¡æ”¹åˆ™æµè§ˆå™¨ä¸ä¼šåŠ è½½è„šæœ¬
* äº‹ä»¶å±æ€§ å¦‚`onclick='console.log("fuck")'`
* URLåè®® å¯ä»¥åœ¨urlçš„ä½ç½®å†™å…¥ä»£ç ,åŒ…æ‹¬æµè§ˆå™¨çš„åœ°å€æ ã€‚ å¦‚æœä»£ç è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæµè§ˆå™¨å°±ä¼šæ–°å»ºä¸€ä¸ªæ–‡æ¡£ï¼Œå±•ç¤ºè¿™ä¸ªå­—ç¬¦ä¸²çš„å†…å®¹ï¼ŒåŸæœ‰æ–‡æ¡£å†…å®¹ä¼šæ¶ˆå¤±

scriptå…ƒç´ å·¥ä½œåŸç†
* æµè§ˆå™¨ä¸€è¾¹ä¸‹è½½htmlä¸€è¾¹è§£æ
* é‡åˆ°scriptå°±æš‚åœè§£æï¼ŒæŠŠç½‘é¡µæ¸²æŸ“æƒäº¤ç»™jså¼•æ“
* å¦‚æœscriptå¼•ç”¨äº†å¤–éƒ¨è„šæœ¬ï¼Œåˆ™å…ˆä¸‹è½½è„šæœ¬å†æ‰§è¡Œï¼Œå¦åˆ™ç›´æ¥æ‰§è¡Œå…¶ä¸­ä»£ç 
* jsæ‰§è¡Œå®Œæ¯•ï¼Œæ§åˆ¶æƒäº¤è¿˜æ¸²æŸ“å¼•æ“

å­˜åœ¨çš„é—®é¢˜ä»¥åŠåº”å¯¹æªæ–½
* å¦‚æœå¤–éƒ¨è„šæœ¬åŠ è½½æ—¶é—´å¾ˆé•¿ï¼Œåˆ™æµè§ˆå™¨ä¼šä¸€ç›´ç­‰å¾…ï¼Œå¤„ç†åŠæ³•æ˜¯æŠŠscriptæ ‡ç­¾æ”¾åœ¨åº•éƒ¨ï¼Œæˆ–è€…ç»‘å®šscriptæ ‡ç­¾çš„loadäº‹ä»¶
* å¦‚æœè„šæœ¬åŠ è½½æ—¶è°ƒç”¨äº†è¿˜æ²¡è§£æå®Œæˆçš„domèŠ‚ç‚¹ä¼šæŠ¥é”™ï¼Œè§£å†³åŠæ³•æ˜¯æ·»åŠ DOMContentLoadedäº‹ä»¶çš„å›è°ƒå‡½æ•°
* å¦‚æœæœ‰å¤šä¸ªscriptæ ‡ç­¾ï¼Œæµè§ˆå™¨ä¼šå¹¶è¡Œä¸‹è½½ï¼Œä½†æ˜¯æ‰§è¡Œæ—¶ä¼šæŒ‰ç…§å…ˆåé¡ºåºæ‰§è¡Œ
* cssåŠ è½½ä¸ä¼šé˜»å¡DOMæ ‘çš„è§£æï¼Œä½†æ˜¯ä¼šé˜»å¡DOMæ ‘çš„æ¸²æŸ“
* å¯¹äºæ¥è‡ªäºåŒä¸€ä¸ªåŸŸåçš„èµ„æºï¼ŒåŒæ—¶æœ€å¤šä¸‹è½½6-20ä¸ªèµ„æºï¼Œå³æœ€å¤šåŒæ—¶æ‰“å¼€çš„TCPè¿æ¥æœ‰é™åˆ¶ã€‚
* deferå±æ€§å»¶è¿Ÿè„šæœ¬æ‰§è¡Œï¼Œç­‰åˆ°DOMåŠ è½½å®Œæˆåå†æ‰§è¡Œï¼Œå¯¹äºåŠ¨æ€ç”Ÿæˆçš„scriptæ ‡ç­¾ï¼Œdeferå±æ€§ä¸èµ·ä½œç”¨
* asyncå±æ€§å¼‚æ­¥ä¸‹è½½è„šæœ¬ï¼Œä¸‹è½½å®Œæˆå°±æ‰§è¡Œã€‚æ‰€ä»¥æ— æ³•ä¿è¯scriptæ ‡ç­¾çš„æ‰§è¡Œé¡ºåºï¼Œè°å…ˆä¸‹è½½å®Œæˆè°å°±æ‰§è¡Œã€‚
* åŠ è½½ä½¿ç”¨çš„åè®®é»˜è®¤æ˜¯httpåè®®
* æµè§ˆå™¨çš„æ ¸å¿ƒï¼š æ¸²æŸ“å¼•æ“å’Œjsæ‰§è¡Œå¼•æ“

æ¸²æŸ“çš„æ­¥éª¤ï¼š
1. è§£æHTMLä¸ºDOM,è§£æcssä¸ºCSSOM  
2. å°†DOMå’ŒCSSOMåˆæˆä¸ºæ¸²æŸ“æ ‘
3. è®¡ç®—å¸ƒå±€  
4. ç»˜åˆ¶

> ä»¥ä¸Šæ­¥éª¤å¹¶éä¸¥æ ¼æŒ‰é¡ºåºæ‰§è¡Œ,æœ‰å¯èƒ½ç¬¬ä¸€æ­¥è¿˜æ²¡å®Œæˆå°±å¼€å§‹ç¬¬äºŒæ­¥å’Œç¬¬ä¸‰æ­¥

é‡æµé‡ç»˜ï¼šé‡æµå¿…ç„¶å¯¼è‡´é‡ç»˜ï¼Œé‡ç»˜ä¸ä¸€å®šéœ€è¦é‡æµã€‚å…¶ä¸­é‡è¦çš„ä¼˜åŒ–å°±æ˜¯å°†ä»£ç æ”¾å…¥`window.requestAnimationFrame(callback)`,è¡¨ç¤ºåœ¨ä¸‹ä¸€æ¬¡é‡ç»˜ä¹‹å‰æ‰§è¡Œå›è°ƒå‡½æ•°,é€šå¸¸æ˜¯æ¯ç§’60æ¬¡ã€‚

jså¼•æ“ï¼š
* è§£é‡Šå‹è¯­è¨€ï¼Œä¸éœ€è¦ç¼–è¯‘ï¼Œç”±è§£é‡Šå™¨å®æ—¶è¿è¡Œã€‚ç¼ºç‚¹æ˜¯æ¯æ¬¡è¿è¡Œéƒ½è¦è°ƒç”¨è§£é‡Šå™¨ï¼Œç³»ç»Ÿå¼€é”€å¤§ï¼Œè¿è¡Œé€Ÿåº¦æ…¢ã€‚
* ä¸€èˆ¬jså¼•æ“ä¼šæŠŠä»£ç æ•´ç†æˆASTæŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åç¿»è¯‘æˆä¸­é—´å­—èŠ‚ç ï¼Œå†è§£é‡Šæ‰§è¡Œå­—èŠ‚ç ã€‚
* ç°ä»£æµè§ˆå™¨ä¸€èˆ¬é‡‡ç”¨å³æ—¶ç¼–è¯‘ï¼Œå³å­—èŠ‚ç åªåœ¨è¿è¡Œæ—¶ç¼–è¯‘ï¼Œç”¨åˆ°å“ªä¸€è¡Œå°±ç¼–è¯‘åˆ°å“ªä¸€è¡Œï¼Œå¹¶ä¸”ç¼“å­˜ç¼–è¯‘ç»“æœã€‚
* å­—èŠ‚ç ä¸€èˆ¬è¿è¡Œåœ¨è™šæ‹Ÿæœºä¸Šã€‚

## Windowå¯¹è±¡
* alert(),confirm(),prompt()
* open(),close()
* scrollTo(),scrollBy()
* getSelection(),å¾—åˆ°ä¸€ä¸ªSelectionå¯¹è±¡è¡¨ç¤ºç”¨æˆ·ç°åœ¨é€‰ä¸­çš„æ–‡æœ¬
* getComputedStyle()
* requestAnimationFrame()
* requestIdleCallback(callback)  å°†å›è°ƒæ¨è¿Ÿåˆ°ç³»ç»Ÿèµ„æºç©ºé—²æ—¶æ‰§è¡Œã€‚


## Navigatorå¯¹è±¡å’ŒScreenå¯¹è±¡
* Screen.height,Screen.width
* Screen.availHeight,Screen.availWidth  é™¤å»äº†æŸäº›ä¸å¯ç”¨çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚ç³»ç»Ÿä»»åŠ¡æ 

## Cookie
cookieçš„å…ƒä¿¡æ¯
* åå­—
* å€¼
* åˆ°æœŸæ—¶é—´
* æ‰€å±åŸŸå
* ç”Ÿæ•ˆè·¯å¾„  åªæœ‰åœ¨è®¿é—®è¯¥è·¯å¾„åŠå…¶å­è·¯å¾„æ‰æœ‰æ•ˆ

> cookieæ˜¯æœåŠ¡å™¨ä¿å­˜åœ¨æµè§ˆå™¨çš„ä¸€æ®µä¿¡æ¯ï¼Œä¸€èˆ¬ä¸º4kb,ç”¨æˆ·å¯ä»¥è®¾ç½®æµè§ˆå™¨ä¸æ¥å—cookie,ä¹Ÿå¯ä»¥è®¾ç½®ä¸å‘æœåŠ¡å™¨å‘é€cookie,cookieå¯ä»¥é€šè¿‡`document.cookie`è¯»å†™ 

* cookieç”Ÿæˆç”±æœåŠ¡å™¨å“åº”å¤´`Set-Cookie`ç”Ÿæˆï¼Œå¯ä»¥åŒ…å«å¤šä¸ªå±æ€§æ²¡æœ‰æ¬¡åºè¦æ±‚ï¼Œä¸­é—´ç”¨åˆ†å·éš”å¼€
* å¦‚æœæœåŠ¡å™¨æƒ³è¦æ›´æ”¹Cookie,å¿…é¡»ä¿è¯key,domain,path,secureéƒ½åŒ¹é…å¦åˆ™ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„cookie
* æµè§ˆå™¨è¯·æ±‚çš„æ—¶å€™ä¼šè‡ªåŠ¨æºå¸¦cookie,ä¸€èˆ¬åœ¨Cookieå­—æ®µé‡Œé¢,`Cookie:name=value1;name=value2`,å¤šä¸ªCookieç”¨åˆ†å·éš”å¼€,æµè§ˆå™¨æ”¶åˆ°cookieå¹¶ä¸èƒ½ç¡®å®šCookieçš„è¿‡æœŸæ—¶é—´

Cookieçš„å±æ€§
* Expires,Max-Age ä¼˜å…ˆçº§åè€…é«˜äºå‰è€…,å‰è€…è¡¨ç¤ºä¸€ä¸ªå…·ä½“çš„UTCæ—¶é—´,åè€…è¡¨ç¤ºä»ç°åœ¨å¼€å§‹çš„ç§’æ•°ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœSet-cookieæ²¡æœ‰è¿™ä¸¤ä¸ªå±æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªcookieæ˜¯ä¸€ä¸ªsession cookie
* Domain,path  å¦‚æœæ²¡æœ‰æŒ‡å®šDomain,æµè§ˆå™¨è¯·æ±‚æ—¶é»˜è®¤ä¸ºå½“å‰åŸŸåä¸”å­åŸŸåä¸ä¼šé™„å¸¦è¿™ä¸ªCookieã€‚
* Secure,HttpOnly Secureè¡¨ç¤ºæµè§ˆå™¨åªèƒ½é€šè¿‡httpsåè®®å‘é€cookieåˆ°å®¢æˆ·ç«¯ï¼Œhttponlyå±æ€§æŒ‡å®šè¯¥cookieæ— æ³•è¢«è„šæœ¬è¯»å–åˆ°
* SameSite,ç”¨æ¥é˜²æ­¢CSRFæ”»å‡»ï¼Œè¯¥å±æ€§æœ‰ä¸‰ä¸ªç­‰çº§ã€‚
1.strict å®Œå…¨ç¦æ­¢ç¬¬ä¸‰æ–¹cookie
2.Lax é™¤äº†å¯¼èˆªåˆ°ç›®æ ‡ç½‘å€çš„getè¯·æ±‚(é“¾æ¥,é¢„åŠ è½½è¯·æ±‚,GETè¡¨å•)ï¼Œå…¶ä½™å‡ä¸å‘é€cookieã€‚è°·æ­Œæµè§ˆå™¨ä¸€èˆ¬æ˜¯Laxä¸ºé»˜è®¤å€¼
3.None 

## XMLHttpRequestå¯¹è±¡
> ç”¨è„šæœ¬å‘èµ·httpè¯·æ±‚,XMLHttpRequestæ˜¯ä¸»è¦æ¥å£

* readyState
* onreadystatechange
* response
* responseType
* withCredentials è·¨åŸŸè¯·æ±‚æ˜¯å¦æºå¸¦cookie
* open()
* send()
* setRequestHeader()

## åŒæºé™åˆ¶
> åè®®ç›¸åŒï¼ŒåŸŸåç›¸åŒï¼Œç«¯å£ç›¸åŒ

ä¸€èˆ¬éåŒæºæœ‰å¦‚ä¸‹é™åˆ¶
* æ— æ³•å…±äº«cookie,localStorage,IndexDB
* æ— æ³•æ¥è§¦DOM
* æ— æ³•å‘é€AJAX

> è·¨çª—å£é€šä¿¡,postMessage()æ¥å£

AjaxåŒæºé™åˆ¶çš„è§„é¿:
* JSONP
* WebSocket
* CORS

## CORS
CORSè¯·æ±‚åˆ†ä¸ºä¸¤ç±»,ç®€å•è¯·æ±‚å’Œéç®€å•è¯·æ±‚
> ç®€å•è¯·æ±‚åŒ…æ‹¬HEAD,POST,GET å¹¶ä¸”å¤´ä¿¡æ¯åªæœ‰æŒ‡å®šçš„å‡ ä¸ªã€‚ç®€å•è¯·æ±‚ä¼šè‡ªåŠ¨åœ¨è¯·æ±‚å¤´æ·»åŠ `Origin`å­—æ®µï¼Œå¦‚æœåœ¨è®¸å¯èŒƒå›´å†…ï¼ŒæœåŠ¡å™¨è¿”å›å¤šå‡ºå‡ ä¸ªå¤´ä¿¡æ¯ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ˜¯`Access-Control-Allow-Origin`  

> éç®€å•è¯·æ±‚ä¼šå…ˆå‘å‡ºä¸€ä¸ªé¢„æ£€è¯·æ±‚ï¼Œè¯¢é—®æœåŠ¡å™¨å½“å‰åŸŸåæ˜¯å¦åœ¨è®¸å¯åå•ä¹‹å†…ä»¥åŠå¯ä»¥ä½¿ç”¨çš„è¯·æ±‚æ–¹æ³•å’Œè¯·æ±‚å¤´å­—æ®µï¼Œå¾—åˆ°è‚¯å®šç­”å¤æ‰ä¼šæ­£å¼å‘èµ·AJAXè¯·æ±‚ã€‚é¢„æ£€è¯·æ±‚çš„æ–¹æ³•æ˜¯OPTIONS,é€šè¿‡é¢„æ£€è¯·æ±‚åæ¯æ¬¡è¯·æ±‚å°±è·Ÿç®€å•è¯·æ±‚ä¸€æ ·ã€‚

## Storageæ¥å£
* setItem()
* getItem()
* removeItem()
* clear()

## Historyæ¥å£
* back()
* forward()
* go()
* pushState() åœ¨å†å²ä¸­æ·»åŠ æ–°çºªå½•
* replaceState() ä¿®æ”¹å½“å‰è®°å½•
* popstateäº‹ä»¶,åªæœ‰ç”¨æˆ·ç‚¹å‡»äº†å€’é€€å‰è¿›æ‰ä¼šè§¦å‘ã€‚
* åä¸‰ä¸ªAPIæ˜¯å‰ç«¯è·¯ç”±çš„åº•å±‚å®ç°(æ”¹å˜urlä¸åˆ·æ–°,æ£€æµ‹urlæ”¹å˜) 

## URLå¯¹è±¡
å…¨å±€çš„ç¼–ç è§£ç æ–¹æ³•
* encodeURI()
* decodeURI()
* encodeURIComponent()
* decodeURIComponent()

## ArrayBufferå’ŒBlobå¯¹è±¡

## File,FileList,FileReader

## FormDataå¯¹è±¡
> é€šè¿‡è„šæœ¬å®Œæˆè¡¨å•çš„æäº¤

è¡¨å•çš„enctype
* application/x-www-form-urlencoded
* text/plain
* multipart/form-data æ–‡ä»¶ä¸Šä¼ çš„æ ¼å¼







